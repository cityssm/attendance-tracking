"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var t;const s=exports.Attend,e=s.callOuts,a=document.querySelector("#callOuts--searchFilter"),l=document.querySelector("#callOuts--searchResults");function n(t){const a=t.currentTarget,l="1"===a.dataset.isFavourite,n=a.closest(".panel-block").dataset.listId;cityssm.postJSON(`${s.urlPrefix}/attendance/${l?"doRemoveFavouriteCallOutList":"doAddFavouriteCallOutList"}`,{listId:n},t=>{const s=t;s.success?(e.callOutLists=s.callOutLists,i()):bulmaJS.alert({title:"Error Updating Favourites",message:"Please try again."})})}function i(){var t,s,i,r,c;const u=document.createElement("div");u.className="panel";const d=a.value.trim().toLowerCase().split(" ");t:for(const a of e.callOutLists){const e=`${a.listName} ${null!==(t=a.listDescription)&&void 0!==t?t:""}`.toLowerCase();for(const t of d)if(!e.includes(t))continue t;const l=document.createElement("div");l.className="panel-block is-block",l.dataset.listId=a.listId.toString();const p=(null!==(s=a.listDescription)&&void 0!==s?s:"").replace(/\n/g,"<br />");l.innerHTML=`<div class="columns is-mobile">\n        <div class="column is-narrow">\n          <button class="button is-white" data-is-favourite="${a.isFavourite?"1":"0"}" data-tooltip="Toggle Favourite" type="button" aria-label="Toggle Favourite">\n            ${a.isFavourite?'<i class="fas fa-star" aria-hidden="true"></i><span class="is-sr-only">Favourite</span>':'<i class="far fa-star" aria-hidden="true"></i><span class="is-sr-only">Not Favourite</span>'}\n          </button>\n        </div>\n        <div class="column">\n          <a class="is-block" href="#">\n          <strong>${a.listName}</strong><br />\n            <span class="is-size-7">${p}</span>\n          </a>\n        </div>\n        <div class="column is-narrow">\n        ${null!==(i=a.allowSelfSignUp)&&void 0!==i&&i?'<span class="tag is-light is-info">\n              <span class="icon is-small"><i class="fas fa-hand-paper" aria-hidden="true"></i></span>\n              <span>Self Sign Up</span>\n              </span>':""} \n          <span class="tag" data-tooltip="Members">\n            <span class="icon is-small"><i class="fas fa-hard-hat" aria-hidden="true"></i></span>\n            <span>${null!==(r=a.callOutListMembersCount)&&void 0!==r?r:""}</span>\n          </span>\n        </div>\n        </div>`,null===(c=l.querySelector("button"))||void 0===c||c.addEventListener("click",n);const v=l.querySelector("a");v.dataset.cy=a.listName,v.addEventListener("click",o),u.append(l)}u.hasChildNodes()?(l.innerHTML="",l.append(u)):l.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no call out lists that meet your search criteria.</p>\n        </div>'}function o(t){t.preventDefault();const s=t.currentTarget.closest(".panel-block").dataset.listId;e.openCallOutList(s,i)}null===(t=document.querySelector("#callOuts--create"))||void 0===t||t.addEventListener("click",()=>{let t;function a(a){a.preventDefault(),cityssm.postJSON(`${s.urlPrefix}/attendance/doCreateCallOutList`,a.currentTarget,s=>{const a=s;e.callOutLists=a.callOutLists,i(),e.openCallOutList(a.listId),t()})}cityssm.openHtmlModal("callOuts-createList",{onshown(s,e){var l;t=e,bulmaJS.toggleHtmlClipped(),s.querySelector("#callOutListAdd--listName").focus(),null===(l=s.querySelector("#form--callOutListAdd"))||void 0===l||l.addEventListener("submit",a)},onremoved(){bulmaJS.toggleHtmlClipped()}})}),i(),a.addEventListener("keyup",i)})();