"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var t;const s=exports.MonTY,e=document.querySelector("#callOuts--searchFilter"),a=document.querySelector("#callOuts--searchResults");function l(t){const e=t.currentTarget,a="1"===e.dataset.isFavourite,l=e.closest(".panel-block").dataset.listId;cityssm.postJSON(s.urlPrefix+(a?"/attendance/doRemoveFavouriteCallOutList":"/attendance/doAddFavouriteCallOutList"),{listId:l},t=>{const e=t;e.success?(s.callOuts.callOutLists=e.callOutLists,n()):bulmaJS.alert({title:"Error Updating Favourites",message:"Please try again."})})}function n(){var t,n,o,c;const r=document.createElement("div");r.className="panel";const u=e.value.trim().toLowerCase().split(" ");t:for(const e of s.callOuts.callOutLists){const s=(e.listName+" "+(null!==(t=e.listDescription)&&void 0!==t?t:"")).toLowerCase();for(const t of u)if(!s.includes(t))continue t;const a=document.createElement("div");a.className="panel-block is-block",a.dataset.listId=e.listId.toString();const d=(null!==(n=e.listDescription)&&void 0!==n?n:"").replace(/\n/g,"<br />");a.innerHTML=`<div class="columns is-mobile">\n        <div class="column is-narrow">\n          <button class="button is-white" data-is-favourite="${e.isFavourite?"1":"0"}" data-tooltip="Toggle Favourite" type="button" aria-label="Toggle Favourite">\n            ${e.isFavourite?'<i class="fas fa-star" aria-hidden="true"></i><span class="is-sr-only">Favourite</span>':'<i class="far fa-star" aria-hidden="true"></i><span class="is-sr-only">Not Favourite</span>'}\n          </button>\n        </div>\n        <div class="column">\n          <a class="is-block" href="#">\n          <strong>${e.listName}</strong><br />\n            <span class="is-size-7">${d}</span>\n          </a>\n        </div>\n        <div class="column is-narrow">\n        ${e.allowSelfSignUp?'<span class="tag is-light is-info">\n              <span class="icon is-small"><i class="fas fa-hand-paper" aria-hidden="true"></i></span>\n              <span>Self Sign Up</span>\n              </span>':""} \n          <span class="tag" data-tooltip="Members">\n            <span class="icon is-small"><i class="fas fa-hard-hat" aria-hidden="true"></i></span>\n            <span>${null!==(o=e.callOutListMembersCount)&&void 0!==o?o:""}</span>\n          </span>\n        </div>\n        </div>`,null===(c=a.querySelector("button"))||void 0===c||c.addEventListener("click",l);const p=a.querySelector("a");p.dataset.cy=e.listName,p.addEventListener("click",i),r.append(a)}r.hasChildNodes()?(a.innerHTML="",a.append(r)):a.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no call out lists that meet your search criteria.</p>\n        </div>'}function i(t){var e;t.preventDefault();const a=t.currentTarget.closest(".panel-block").dataset.listId;null===(e=s.callOuts)||void 0===e||e.openCallOutList(a,n)}null===(t=document.querySelector("#callOuts--create"))||void 0===t||t.addEventListener("click",()=>{let t;function e(e){e.preventDefault(),cityssm.postJSON(s.urlPrefix+"/attendance/doCreateCallOutList",e.currentTarget,e=>{var a;const l=e;s.callOuts.callOutLists=l.callOutLists,n(),null===(a=s.callOuts)||void 0===a||a.openCallOutList(l.listId),t()})}cityssm.openHtmlModal("callOuts-createList",{onshown(s,a){var l;t=a,bulmaJS.toggleHtmlClipped(),s.querySelector("#callOutListAdd--listName").focus(),null===(l=s.querySelector("#form--callOutListAdd"))||void 0===l||l.addEventListener("submit",e)},onremoved(){bulmaJS.toggleHtmlClipped()}})}),n(),e.addEventListener("keyup",n)})();